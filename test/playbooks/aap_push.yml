---
- name: push -- update application repo
  hosts: appnodes
  remote_user: student1
  gather_facts: false
  tasks:

  - name: Hello Message
    debug:
      msg: "{{ awx_webhook_payload.repository.clone_url }} {{ awx_webhook_payload.repository.name }}"

  - name: push -- Update application repository to event ref 
    ansible.builtin.git:
      repo: "{{ awx_webhook_payload.repository.clone_url }}"
      accept_hostkey: true
      dest: "/tmp/{{ awx_webhook_payload.repository.name }}"
      clone: true
      update: true
      version: "{{ awx_webhook_payload.ref | split('/') | last }}"
